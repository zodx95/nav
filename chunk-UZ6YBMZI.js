import{a as X,b as Y}from"./chunk-BOSNJHZJ.js";import{d as Z,f as tt,h as et,i as nt,j as it,k as ot,l as rt}from"./chunk-4YAQHFW3.js";import"./chunk-B5OHSRSU.js";import{n as K,o as Q}from"./chunk-PSADVN62.js";import{a as v}from"./chunk-R4WQ5N2L.js";import"./chunk-MGCZXTDC.js";import"./chunk-OHYEV22C.js";import{f as J,j as q}from"./chunk-OFEDYP7M.js";import"./chunk-5KSEFLRL.js";import"./chunk-V7KWIRDT.js";import{$b as F,Aa as W,Ac as H,Ec as S,Vb as $,Yb as B,hc as A,jc as j,wc as U,xc as R,zc as G}from"./chunk-7I5JFXBX.js";import{Ad as E,Bd as k,Db as z,Dc as C,Ec as x,Fc as T,Jd as D,Nc as P,Rd as O,Ub as g,Vb as s,Wb as r,a as w,b as N,cc as h,fc as u,ib as o,ic as d,sa as c,sb as b,ta as p,te as M,uc as V,xb as L,xc as l,yc as _,zc as y,ze as f}from"./chunk-GZC6GDUE.js";function st(m,n){if(m&1&&(s(0,"div"),l(1),r()),m&2){let e=d().$implicit;o(),_(e.desc)}}function mt(m,n){if(m&1){let e=h();s(0,"input",17),T("ngModelChange",function(i){c(e);let a=d().$implicit;return x(a.desc,i)||(a.desc=i),p(i)}),r()}if(m&2){let e=d().$implicit;C("ngModel",e.desc)}}function lt(m,n){if(m&1){let e=h();s(0,"a",18),u("nzOnConfirm",function(){c(e);let i=d().index,a=d();return p(a.handleDelete(i))}),l(1),r()}if(m&2){let e=d(2);g("nzPopconfirmTitle",e.$t("_confirmDel")),o(),y(" ",e.$t("_del")," ")}}function ct(m,n){if(m&1){let e=h();s(0,"tr")(1,"td")(2,"nz-switch",9),T("ngModelChange",function(i){let a=c(e).$implicit;return x(a.noOpen,i)||(a.noOpen=i),p(i)}),r()(),s(3,"td")(4,"input",10),T("ngModelChange",function(i){let a=c(e).$implicit;return x(a.name,i)||(a.name=i),p(i)}),r()(),s(5,"td")(6,"input",11),u("change",function(i){let a=c(e).index,at=d();return p(at.onColorChange(i,a))}),r(),l(7),r(),s(8,"td")(9,"input",10),T("ngModelChange",function(i){let a=c(e).$implicit;return x(a.sort,i)||(a.sort=i),p(i)}),r()(),s(10,"td"),z(11,st,2,1,"div",12)(12,mt,1,1,"input",13),r(),s(13,"td")(14,"a",14),u("click",function(){let i=c(e).index,a=d();return p(a.moveUp(i))}),l(15),r(),s(16,"a",15),u("click",function(){let i=c(e).index,a=d();return p(a.moveDown(i))}),l(17),r(),z(18,lt,2,2,"a",16),r()()}if(m&2){let e=n.$implicit,t=n.index,i=d();o(2),C("ngModel",e.noOpen),o(2),C("ngModel",e.name),o(2),g("value",e.color),o(),y(" - ",e.color," "),o(2),C("ngModel",e.sort),o(2),g("ngIf",e.isInner),o(),g("ngIf",!e.isInner),o(2),V("invisible",t===0),o(),_(i.$t("_moveUp")),o(2),_(i.$t("_moveDown")),o(),g("ngIf",!e.isInner)}}var I=class m{constructor(n,e){this.message=n;this.modal=e}$t=f;tagList=M();submitting=!1;incrementId=Math.max(...M().map(n=>Number(n.id)))+1;ngOnInit(){}moveUp(n){if(n===0)return;let e=this.tagList[n],t=this.tagList[n-1];this.tagList[n-1]=e,this.tagList[n]=t}moveDown(n){if(n===this.tagList.length-1)return;let e=this.tagList[n],t=this.tagList[n+1];this.tagList[n+1]=e,this.tagList[n]=t}onColorChange(n,e){let t=n.target.value;this.tagList[e].color=t}handleAdd(){this.tagList.some(e=>!e.name.trim())||(this.incrementId+=1,this.tagList.unshift({id:this.incrementId,name:"",color:"#f50000",desc:"",isInner:!1}))}handleDelete(n){this.tagList.splice(n,1)}handleSubmit(){if(this.submitting)return;let n={};if(this.tagList.forEach(t=>{t.name?.trim?.()&&(n[t.name]=N(w({},t),{name:void 0}))}),Object.keys(n).length!==this.tagList.length){this.message.error(f("_repeatAdd"));return}let e=[...this.tagList].map(t=>(t.sort||="",typeof t.sort=="string"&&(t.sort=t.sort.trim()),t.sort===""&&delete t.sort,Number.isNaN(Number(t.sort))&&delete t.sort,t.sort!=null&&(t.sort=Number(t.sort)),w({},t)));this.modal.info({nzTitle:f("_syncDataOut"),nzOkText:f("_confirmSync"),nzContent:f("_confirmSyncTip"),nzOnOk:()=>{this.submitting=!0,W({message:"update tag",content:JSON.stringify(e),path:O}).then(()=>{this.message.success(f("_syncSuccessTip"))}).finally(()=>{this.submitting=!1})}})}trackByItem(n,e){return e.id}static \u0275fac=function(e){return new(e||m)(b(S),b(v))};static \u0275cmp=L({type:m,selectors:[["system-tag"]],features:[P([v,S])],decls:22,vars:14,consts:[["basicTable",""],["nz-button","",1,"add-btn",3,"click","nzLoading"],["nz-button","","nzType","primary",3,"click","nzLoading"],[3,"nzData","nzShowPagination"],[1,"min-w-[80px]"],[1,"min-w-[150px]"],[1,"min-w-[160px]"],[1,"min-w-[200px]"],[4,"ngFor","ngForOf","ngForTrackBy"],[3,"ngModelChange","ngModel"],["nz-input","","maxlength","10",3,"ngModelChange","ngModel"],["type","color",3,"change","value"],[4,"ngIf"],["nz-input","","maxlength","20",3,"ngModel","ngModelChange",4,"ngIf"],[3,"click"],[1,"mx-2.5",3,"click"],["nz-popconfirm","","nzOkType","danger","nzPopconfirmPlacement","bottom","class","!text-red-500",3,"nzPopconfirmTitle","nzOnConfirm",4,"ngIf"],["nz-input","","maxlength","20",3,"ngModelChange","ngModel"],["nz-popconfirm","","nzOkType","danger","nzPopconfirmPlacement","bottom",1,"!text-red-500",3,"nzOnConfirm","nzPopconfirmTitle"]],template:function(e,t){if(e&1){let i=h();s(0,"button",1),u("click",function(){return c(i),p(t.handleAdd())}),l(1),r(),s(2,"button",2),u("click",function(){return c(i),p(t.handleSubmit())}),l(3),r(),s(4,"nz-table",3,0)(6,"thead")(7,"tr")(8,"th",4),l(9),r(),s(10,"th",5),l(11),r(),s(12,"th",6),l(13),r(),s(14,"th",5),l(15),r(),s(16,"th",7),l(17),r(),s(18,"th",7),l(19),r()()(),s(20,"tbody"),z(21,ct,19,12,"tr",8),r()()}e&2&&(g("nzLoading",t.submitting),o(),y(" ",t.$t("_addRow"),`
`),o(),g("nzLoading",t.submitting),o(),y(" ",t.$t("_save"),`
`),o(),g("nzData",t.tagList)("nzShowPagination",!1),o(5),_(t.$t("_noPublic")),o(2),_(t.$t("_tagName")),o(2),_(t.$t("_color")),o(2),_(t.$t("_sort")),o(2),_(t.$t("_remark")),o(2),_(t.$t("_action")),o(2),g("ngForOf",t.tagList)("ngForTrackBy",t.trackByItem))},dependencies:[j,$,B,A,F,D,E,k,H,G,U,R,q,J,rt,nt,Z,tt,ot,et,it,Q,K,Y,X],styles:[".add-btn[_ngcontent-%COMP%]{margin-bottom:20px;margin-right:20px}"]})};export{I as default};
